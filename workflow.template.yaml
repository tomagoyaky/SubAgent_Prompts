# 工作流元信息（Meta）- 新增RPC调度特性标识
meta:
  workflow_name: "通用软件开发标准工作流（RPC调度版）"
  workflow_description: "基于RPC协议的主节点中心化调度工作流，master_node通过RPC指令协调所有子节点，子节点通过RPC返回执行结果，支持全局变量驱动的智能决策、条件判断与循环迭代"
  workflow_version: "5.0.0"
  create_time: "2026-02-05"
  update_time: "2026-02-05"
  architecture_type: "通用架构（兼容所有架构）"
  master_node_id: "MASTER-MANAGE-000"  # 主节点RPC服务ID
  manual_nodes: ["MANUAL-MERGE-CODE-011"]
  workflow_features: ["主节点RPC中心化调度", "语义化节点ID", "RPC结构化交互", "全局变量驱动", "条件判断", "循环迭代", "人工节点"]

# 全局变量（Global）- 保留路径配置（RPC数据持久化路径），新增RPC通用配置
global:
  # 项目基础通用信息
  project_name: "通用软件开发项目"
  project_env: "开发环境"
  project_code_repo: "项目代码仓库地址"
  
  # 通用技术栈定义
  frontend_tech_stack: "通用前端技术栈"
  backend_tech_stack: "通用后端技术栈"
  api_protocol: "RESTful RPC"  # RPC协议类型
  database_type: "通用数据库类型"
  
  # RPC数据持久化路径（RPC请求/响应数据存放路径，非调度字段）
  original_req_path: "/docs/原始需求/"
  master_rpc_path: "/rpc/master/"  # 主节点RPC指令/响应存放路径
  prd_save_path: "/docs/需求文档/"
  design_save_path: "/docs/设计文档/"
  arch_save_path: "/docs/架构文档/"
  dev_task_path: "/docs/开发任务/"
  code_dev_path: "/code/"
  review_report_path: "/docs/评审报告/"
  test_case_path: "/docs/测试用例/"
  test_report_path: "/docs/测试报告/"
  bug_record_path: "/docs/bug记录/"
  fix_report_path: "/docs/修复报告/"

  # RPC通用配置
  rpc_config:
    rpc_timeout: 30000  # RPC超时时间（毫秒）
    rpc_data_format: "markdown"  # RPC数据交互格式（统一.md）
    rpc_version: "1.0.0"  # RPC协议版本

  # 流程控制全局变量（主节点RPC决策核心依据）
  process_control:
    current_exec_node: ""  # 当前执行的子节点RPC服务ID
    next_exec_node: ""     # 下一个待执行的子节点RPC服务ID
    code_review_result: "pending"  # pass=通过, fail=驳回
    unit_test_pass_threshold: 95   # 单元测试通过率阈值
    unit_test_actual_pass_rate: 0  # 单元测试实际通过率
    integration_test_result: "pending"  # pass=通过, fail=失败
    system_test_result: "pending"  # pass=通过, fail=待修复
    has_remaining_bugs: false      # true=有未修复bug, false=无
    current_bug_fix_iteration: 0   # bug修复当前迭代次数
    max_bug_fix_iteration: 3       # bug修复最大迭代次数
    workflow_status: "ready"      # ready/executing/finished/terminated

# 工作流节点集合（Nodes）- 核心：RPC调度字段全覆盖，主节点中心化管控
nodes:
  # 核心主节点：项目管理与RPC智能调度（master_node）
  - node_id: "MASTER-MANAGE-000"
    name: "项目管理主节点（RPC调度中心）"
    description: "工作流RPC调度核心，通过RPC指令下发任务、接收子节点执行结果，基于全局变量智能动态决策下一个执行节点"
    type: "自动节点"
    # 主节点RPC输入：人类初始需求 + 所有子节点RPC响应结果
    input:
      # 初始RPC输入：人类原始需求（非节点间调度，保留原始标识）
      - rpc_source_service: "HUMAN-INPUT"  # 人类输入RPC服务标识
        rpc_request_path: "${global.original_req_path}"
        rpc_response_name: "原始需求文档.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
      - rpc_source_service: "HUMAN-INPUT"
        rpc_request_path: "${global.original_req_path}"
        rpc_response_name: "项目背景与业务目标.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
      # 子节点RPC响应输入（所有子节点执行完成后通过RPC返回）
      - rpc_source_service: "REQ-ANALYSIS-001"
        rpc_request_path: "${global.prd_save_path}"
        rpc_response_name: "需求分析RPC响应结果.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
      - rpc_source_service: "PRD-DESIGN-002"
        rpc_request_path: "${global.design_save_path}"
        rpc_response_name: "产品设计RPC响应结果.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
      - rpc_source_service: "ARCH-DESIGN-003"
        rpc_request_path: "${global.arch_save_path}"
        rpc_response_name: "架构设计RPC响应结果.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
      - rpc_source_service: "DEV-TASK-BREAK-004"
        rpc_request_path: "${global.dev_task_path}"
        rpc_response_name: "任务拆解RPC响应结果.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
      - rpc_source_service: "DEV-CODE-IMPLEMENT-005"
        rpc_request_path: "${global.code_dev_path}"
        rpc_response_name: "代码开发RPC响应结果.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
      - rpc_source_service: "DEV-CODE-REVIEW-006"
        rpc_request_path: "${global.review_report_path}"
        rpc_response_name: "代码评审RPC响应结果.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
      - rpc_source_service: "TEST-UNIT-007"
        rpc_request_path: "${global.test_report_path}"
        rpc_response_name: "单元测试RPC响应结果.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
      - rpc_source_service: "TEST-INTEGRATION-008"
        rpc_request_path: "${global.test_report_path}"
        rpc_response_name: "集成测试RPC响应结果.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
      - rpc_source_service: "TEST-SYSTEM-009"
        rpc_request_path: "${global.test_report_path}"
        rpc_response_name: "系统测试RPC响应结果.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
      - rpc_source_service: "BUG-FIX-ITERATION-010"
        rpc_request_path: "${global.fix_report_path}"
        rpc_response_name: "Bug修复RPC响应结果.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
      - rpc_source_service: "MANUAL-MERGE-CODE-011"
        rpc_request_path: "${global.code_dev_path}"
        rpc_response_name: "代码合并RPC响应结果.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
    # 主节点RPC输出：RPC调度指令、任务请求、流程控制数据（下发给目标子节点）
    output:
      - rpc_content: "工作流启动RPC指令与初始任务分配"
        rpc_target_service: "REQ-ANALYSIS-001"  # RPC目标子节点服务ID
        rpc_request_path: "${global.master_rpc_path}"
        rpc_request_name: "工作流启动RPC调度指令.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
      - rpc_content: "子节点执行任务RPC请求"
        rpc_target_service: "${global.process_control.next_exec_node}"
        rpc_request_path: "${global.master_rpc_path}"
        rpc_request_name: "子节点任务RPC执行指令.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
      - rpc_content: "流程状态与全局变量RPC更新记录"
        rpc_target_service: "MASTER-MANAGE-000"
        rpc_request_path: "${global.master_rpc_path}"
        rpc_request_name: "流程控制RPC变量更新记录.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
      - rpc_content: "工作流结束RPC报告"
        rpc_target_service: "HUMAN-INPUT"
        rpc_request_path: "${global.master_rpc_path}"
        rpc_request_name: "工作流最终RPC执行报告.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
    # 主节点RPC调度逻辑：基于全局变量智能决策下一个RPC目标节点
    connections:
      conditions:
        # 初始状态：RPC下发指令给需求分析节点
        - condition: "global.process_control.workflow_status == 'ready'"
          next_node: ["REQ-ANALYSIS-001"]
        # 需求分析RPC响应完成：RPC调用产品设计节点
        - condition: "global.process_control.current_exec_node == 'REQ-ANALYSIS-001'"
          next_node: ["PRD-DESIGN-002"]
        # 产品设计RPC响应完成：RPC调用架构设计节点
        - condition: "global.process_control.current_exec_node == 'PRD-DESIGN-002'"
          next_node: ["ARCH-DESIGN-003"]
        # 架构设计RPC响应完成：RPC调用任务拆解节点
        - condition: "global.process_control.current_exec_node == 'ARCH-DESIGN-003'"
          next_node: ["DEV-TASK-BREAK-004"]
        # 任务拆解RPC响应完成：RPC调用代码开发节点
        - condition: "global.process_control.current_exec_node == 'DEV-TASK-BREAK-004'"
          next_node: ["DEV-CODE-IMPLEMENT-005"]
        # 代码开发RPC响应完成：RPC调用代码评审节点
        - condition: "global.process_control.current_exec_node == 'DEV-CODE-IMPLEMENT-005'"
          next_node: ["DEV-CODE-REVIEW-006"]
        # 代码评审RPC响应：通过→调用单元测试；驳回→RPC回调代码开发
        - condition: "global.process_control.current_exec_node == 'DEV-CODE-REVIEW-006' && global.process_control.code_review_result == 'pass'"
          next_node: ["TEST-UNIT-007"]
        - condition: "global.process_control.current_exec_node == 'DEV-CODE-REVIEW-006' && global.process_control.code_review_result == 'fail'"
          next_node: ["DEV-CODE-IMPLEMENT-005"]
        # 单元测试RPC响应：达标→调用集成测试；不达标→RPC回调代码开发
        - condition: "global.process_control.current_exec_node == 'TEST-UNIT-007' && global.process_control.unit_test_actual_pass_rate >= global.process_control.unit_test_pass_threshold"
          next_node: ["TEST-INTEGRATION-008"]
        - condition: "global.process_control.current_exec_node == 'TEST-UNIT-007' && global.process_control.unit_test_actual_pass_rate < global.process_control.unit_test_pass_threshold"
          next_node: ["DEV-CODE-IMPLEMENT-005"]
        # 集成测试RPC响应：通过→调用系统测试；失败→RPC回调代码开发
        - condition: "global.process_control.current_exec_node == 'TEST-INTEGRATION-008' && global.process_control.integration_test_result == 'pass'"
          next_node: ["TEST-SYSTEM-009"]
        - condition: "global.process_control.current_exec_node == 'TEST-INTEGRATION-008' && global.process_control.integration_test_result == 'fail'"
          next_node: ["DEV-CODE-IMPLEMENT-005"]
        # 系统测试RPC响应：通过无Bug→调用人工合并；失败有Bug→调用Bug修复
        - condition: "global.process_control.current_exec_node == 'TEST-SYSTEM-009' && global.process_control.system_test_result == 'pass' && global.process_control.has_remaining_bugs == false"
          next_node: ["MANUAL-MERGE-CODE-011"]
        - condition: "global.process_control.current_exec_node == 'TEST-SYSTEM-009' && global.process_control.system_test_result == 'fail' && global.process_control.has_remaining_bugs == true"
          next_node: ["BUG-FIX-ITERATION-010"]
        # Bug修复RPC响应：迭代未达上限→RPC回调系统测试；达上限→终止；无Bug→调用人工合并
        - condition: "global.process_control.current_exec_node == 'BUG-FIX-ITERATION-010' && global.process_control.current_bug_fix_iteration < global.process_control.max_bug_fix_iteration && global.process_control.has_remaining_bugs == true"
          next_node: ["TEST-SYSTEM-009"]
        - condition: "global.process_control.current_exec_node == 'BUG-FIX-ITERATION-010' && global.process_control.current_bug_fix_iteration >= global.process_control.max_bug_fix_iteration"
          next_node: ["工作流终止（人工介入）"]
        - condition: "global.process_control.current_exec_node == 'BUG-FIX-ITERATION-010' && global.process_control.has_remaining_bugs == false"
          next_node: ["MANUAL-MERGE-CODE-011"]
        # 代码合并RPC响应完成：结束工作流
        - condition: "global.process_control.current_exec_node == 'MANUAL-MERGE-CODE-011'"
          next_node: ["工作流结束"]
    system_prompt: |
      你是项目管理主节点（RPC调度中心），工作流的核心大脑，通过RPC协议完成全流程调度。
      核心职责：
      1. 初始阶段：接收人类原始需求RPC数据，启动工作流，更新流程状态为executing，通过RPC下发第一个任务指令给需求分析节点；
      2. 执行阶段：通过RPC实时接收所有子节点的执行结果响应，解析RPC数据并更新全局变量（流程状态、测试结果、Bug状态、迭代次数等）；
      3. 决策阶段：基于全局变量和子节点RPC响应结果，严格按照调度规则智能动态决策下一个RPC目标节点，生成对应的RPC任务执行指令；
      4. 协调阶段：通过RPC将任务指令下发给目标子节点，管控全流程执行节奏，处理分支、循环逻辑；
      5. 收尾阶段：人工合并代码RPC响应完成后，更新流程状态为finished，生成工作流最终RPC执行报告；若Bug修复迭代超上限，更新状态为terminated，触发人工介入；
      6. 所有RPC指令、变量更新记录均按指定路径以.md格式保存，RPC交互严格遵循${global.rpc_config.rpc_version}协议规范。

  # 子节点1：需求接收与产品需求拆解（RPC执行节点）
  - node_id: "REQ-ANALYSIS-001"
    name: "需求接收与拆解（RPC执行节点）"
    description: "接收主节点RPC调度指令，执行需求拆解任务，通过RPC返回执行结果"
    type: "自动节点"
    # 子节点RPC输入：主节点RPC调度指令 + 人类原始需求RPC数据
    input:
      - rpc_source_service: "MASTER-MANAGE-000"
        rpc_request_path: "${global.master_rpc_path}"
        rpc_request_name: "子节点任务RPC执行指令.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
      - rpc_source_service: "HUMAN-INPUT"
        rpc_request_path: "${global.original_req_path}"
        rpc_request_name: "原始需求文档.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
      - rpc_source_service: "HUMAN-INPUT"
        rpc_request_path: "${global.original_req_path}"
        rpc_request_name: "项目背景与业务目标.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
    # 子节点RPC输出：需求分析结果 + RPC响应报告（返回给主节点）
    output:
      - rpc_content: "标准化产品需求文档（PRD）"
        rpc_target_service: "MASTER-MANAGE-000"
        rpc_request_path: "${global.prd_save_path}"
        rpc_response_name: "标准化产品需求文档.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
      - rpc_content: "需求优先级排序清单"
        rpc_target_service: "MASTER-MANAGE-000"
        rpc_request_path: "${global.prd_save_path}"
        rpc_response_name: "需求优先级清单.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
      - rpc_content: "需求边界与约束说明"
        rpc_target_service: "MASTER-MANAGE-000"
        rpc_request_path: "${global.prd_save_path}"
        rpc_response_name: "需求边界说明.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
      - rpc_content: "需求分析RPC执行结果报告"
        rpc_target_service: "MASTER-MANAGE-000"
        rpc_request_path: "${global.prd_save_path}"
        rpc_response_name: "需求分析RPC响应结果.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
    # 子节点RPC执行完成后，响应结果返回主节点
    connections:
      next_node: ["MASTER-MANAGE-000"]
    system_prompt: |
      你是需求分析RPC执行节点，仅负责接收主节点RPC指令并完成具体任务，通过RPC返回结果。
      核心要求：
      1. 基于主节点RPC调度指令和人类原始需求RPC数据，完成无场景绑定的需求拆解；
      2. 输出标准化PRD、需求优先级清单、边界说明，所有RPC响应数据按.md格式保存；
      3. 生成需求分析RPC执行结果报告，通过RPC完整返回给主节点，不做任何流程决策。

  # 子节点2：产品方案设计（RPC执行节点）
  - node_id: "PRD-DESIGN-002"
    name: "产品方案设计（RPC执行节点）"
    description: "接收主节点RPC调度指令，执行产品设计任务，通过RPC返回执行结果"
    type: "自动节点"
    input:
      - rpc_source_service: "MASTER-MANAGE-000"
        rpc_request_path: "${global.master_rpc_path}"
        rpc_request_name: "子节点任务RPC执行指令.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
      - rpc_source_service: "REQ-ANALYSIS-001"
        rpc_request_path: "${global.prd_save_path}"
        rpc_response_name: "标准化产品需求文档.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
      - rpc_source_service: "REQ-ANALYSIS-001"
        rpc_request_path: "${global.prd_save_path}"
        rpc_response_name: "需求优先级清单.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
    output:
      - rpc_content: "产品原型设计稿"
        rpc_target_service: "MASTER-MANAGE-000"
        rpc_request_path: "${global.design_save_path}"
        rpc_response_name: "产品原型设计稿.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
      - rpc_content: "业务流程逻辑图"
        rpc_target_service: "MASTER-MANAGE-000"
        rpc_request_path: "${global.design_save_path}"
        rpc_response_name: "业务流程逻辑图.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
      - rpc_content: "交互设计规范"
        rpc_target_service: "MASTER-MANAGE-000"
        rpc_request_path: "${global.design_save_path}"
        rpc_response_name: "交互设计规范.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
      - rpc_content: "产品设计RPC执行结果报告"
        rpc_target_service: "MASTER-MANAGE-000"
        rpc_request_path: "${global.design_save_path}"
        rpc_response_name: "产品设计RPC响应结果.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
    connections:
      next_node: ["MASTER-MANAGE-000"]
    system_prompt: |
      你是产品设计RPC执行节点，仅负责接收主节点RPC指令并完成具体任务，通过RPC返回结果。
      核心要求：
      1. 基于主节点RPC指令和需求分析RPC响应数据，输出产品原型、业务流程、交互规范；
      2. 所有设计RPC响应数据按.md格式保存，生成设计RPC执行结果报告返回给主节点。

  # 子节点3：技术架构设计（RPC执行节点）
  - node_id: "ARCH-DESIGN-003"
    name: "技术架构设计（RPC执行节点）"
    description: "接收主节点RPC调度指令，执行架构设计任务，通过RPC返回执行结果"
    type: "自动节点"
    input:
      - rpc_source_service: "MASTER-MANAGE-000"
        rpc_request_path: "${global.master_rpc_path}"
        rpc_request_name: "子节点任务RPC执行指令.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
      - rpc_source_service: "PRD-DESIGN-002"
        rpc_request_path: "${global.design_save_path}"
        rpc_response_name: "产品原型设计稿.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
      - rpc_source_service: "PRD-DESIGN-002"
        rpc_request_path: "${global.design_save_path}"
        rpc_response_name: "业务流程逻辑图.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
    output:
      - rpc_content: "技术架构设计方案"
        rpc_target_service: "MASTER-MANAGE-000"
        rpc_request_path: "${global.arch_save_path}"
        rpc_response_name: "技术架构设计方案.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
      - rpc_content: "系统模块划分清单"
        rpc_target_service: "MASTER-MANAGE-000"
        rpc_request_path: "${global.arch_save_path}"
        rpc_response_name: "系统模块划分清单.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
      - rpc_content: "通用接口设计文档"
        rpc_target_service: "MASTER-MANAGE-000"
        rpc_request_path: "${global.arch_save_path}"
        rpc_response_name: "通用接口设计文档.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
      - rpc_content: "架构设计RPC执行结果报告"
        rpc_target_service: "MASTER-MANAGE-000"
        rpc_request_path: "${global.arch_save_path}"
        rpc_response_name: "架构设计RPC响应结果.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
    connections:
      next_node: ["MASTER-MANAGE-000"]
    system_prompt: |
      你是架构设计RPC执行节点，仅负责接收主节点RPC指令并完成具体任务，通过RPC返回结果。
      核心要求：
      1. 基于主节点RPC指令和产品设计RPC响应数据，输出通用技术架构、模块划分、接口文档；
      2. 所有架构RPC响应数据按.md格式保存，生成架构RPC执行结果报告返回给主节点。

  # 子节点4：开发任务拆解（RPC执行节点）
  - node_id: "DEV-TASK-BREAK-004"
    name: "开发任务拆解（RPC执行节点）"
    description: "接收主节点RPC调度指令，执行任务拆解任务，通过RPC返回执行结果"
    type: "自动节点"
    input:
      - rpc_source_service: "MASTER-MANAGE-000"
        rpc_request_path: "${global.master_rpc_path}"
        rpc_request_name: "子节点任务RPC执行指令.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
      - rpc_source_service: "ARCH-DESIGN-003"
        rpc_request_path: "${global.arch_save_path}"
        rpc_response_name: "技术架构设计方案.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
      - rpc_source_service: "ARCH-DESIGN-003"
        rpc_request_path: "${global.arch_save_path}"
        rpc_response_name: "系统模块划分清单.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
    output:
      - rpc_content: "开发任务清单（细粒度）"
        rpc_target_service: "MASTER-MANAGE-000"
        rpc_request_path: "${global.dev_task_path}"
        rpc_response_name: "开发任务清单.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
      - rpc_content: "任务优先级与排期计划"
        rpc_target_service: "MASTER-MANAGE-000"
        rpc_request_path: "${global.dev_task_path}"
        rpc_response_name: "开发任务排期计划.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
      - rpc_content: "通用开发规范文档"
        rpc_target_service: "MASTER-MANAGE-000"
        rpc_request_path: "${global.dev_task_path}"
        rpc_response_name: "通用开发规范文档.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
      - rpc_content: "任务拆解RPC执行结果报告"
        rpc_target_service: "MASTER-MANAGE-000"
        rpc_request_path: "${global.dev_task_path}"
        rpc_response_name: "任务拆解RPC响应结果.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
    connections:
      next_node: ["MASTER-MANAGE-000"]
    system_prompt: |
      你是任务拆解RPC执行节点，仅负责接收主节点RPC指令并完成具体任务，通过RPC返回结果。
      核心要求：
      1. 基于主节点RPC指令和架构设计RPC响应数据，输出细粒度开发任务、排期、开发规范；
      2. 所有任务RPC响应数据按.md格式保存，生成任务拆解RPC执行结果报告返回给主节点。

  # 子节点5：代码开发实现（RPC执行节点）
  - node_id: "DEV-CODE-IMPLEMENT-005"
    name: "代码开发实现（RPC执行节点）"
    description: "接收主节点RPC调度指令，执行代码开发任务，通过RPC返回执行结果"
    type: "自动节点"
    input:
      - rpc_source_service: "MASTER-MANAGE-000"
        rpc_request_path: "${global.master_rpc_path}"
        rpc_request_name: "子节点任务RPC执行指令.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
      - rpc_source_service: "DEV-TASK-BREAK-004"
        rpc_request_path: "${global.dev_task_path}"
        rpc_response_name: "开发任务清单.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
      - rpc_source_service: "DEV-TASK-BREAK-004"
        rpc_request_path: "${global.dev_task_path}"
        rpc_response_name: "通用开发规范文档.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
      # RPC回调修改输入（主节点调度的修改指令）
      - rpc_source_service: "DEV-CODE-REVIEW-006"
        rpc_request_path: "${global.review_report_path}"
        rpc_response_name: "代码评审RPC响应结果.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
      - rpc_source_service: "TEST-UNIT-007"
        rpc_request_path: "${global.test_report_path}"
        rpc_response_name: "单元测试RPC响应结果.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
    output:
      - rpc_content: "各模块开发完成代码说明"
        rpc_target_service: "MASTER-MANAGE-000"
        rpc_request_path: "${global.code_dev_path}"
        rpc_response_name: "模块开发代码说明.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
      - rpc_content: "本地调试日志"
        rpc_target_service: "MASTER-MANAGE-000"
        rpc_request_path: "${global.code_dev_path}"
        rpc_response_name: "本地调试日志.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
      - rpc_content: "开发自测报告"
        rpc_target_service: "MASTER-MANAGE-000"
        rpc_request_path: "${global.test_report_path}"
        rpc_response_name: "开发自测报告.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
      - rpc_content: "代码开发RPC执行结果报告"
        rpc_target_service: "MASTER-MANAGE-000"
        rpc_request_path: "${global.code_dev_path}"
        rpc_response_name: "代码开发RPC响应结果.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
    connections:
      next_node: ["MASTER-MANAGE-000"]
    system_prompt: |
      你是代码开发RPC执行节点，仅负责接收主节点RPC指令并完成具体任务，通过RPC返回结果。
      核心要求：
      1. 基于主节点RPC指令和任务拆解RPC响应数据，完成代码开发与本地调试；若为RPC回调修改，按评审/测试报告调整代码；
      2. 所有开发RPC响应数据按.md格式保存，生成代码开发RPC执行结果报告返回给主节点。

  # 子节点6：代码评审（RPC执行节点）
  - node_id: "DEV-CODE-REVIEW-006"
    name: "代码评审（RPC执行节点）"
    description: "接收主节点RPC调度指令，执行代码评审任务，通过RPC返回执行结果"
    type: "自动节点"
    input:
      - rpc_source_service: "MASTER-MANAGE-000"
        rpc_request_path: "${global.master_rpc_path}"
        rpc_request_name: "子节点任务RPC执行指令.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
      - rpc_source_service: "DEV-CODE-IMPLEMENT-005"
        rpc_request_path: "${global.code_dev_path}"
        rpc_response_name: "模块开发代码说明.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
      - rpc_source_service: "DEV-CODE-IMPLEMENT-005"
        rpc_request_path: "${global.test_report_path}"
        rpc_response_name: "开发自测报告.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
    output:
      - rpc_content: "代码评审报告"
        rpc_target_service: "MASTER-MANAGE-000"
        rpc_request_path: "${global.review_report_path}"
        rpc_response_name: "代码评审报告.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
      - rpc_content: "代码修改建议清单"
        rpc_target_service: "MASTER-MANAGE-000"
        rpc_request_path: "${global.review_report_path}"
        rpc_response_name: "代码修改建议清单.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
      - rpc_content: "代码评审RPC执行结果报告"
        rpc_target_service: "MASTER-MANAGE-000"
        rpc_request_path: "${global.review_report_path}"
        rpc_response_name: "代码评审RPC响应结果.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
    connections:
      next_node: ["MASTER-MANAGE-000"]
    system_prompt: |
      你是代码评审RPC执行节点，仅负责接收主节点RPC指令并完成具体任务，通过RPC返回结果。
      核心要求：
      1. 基于主节点RPC指令和开发RPC响应数据，完成代码规范性、功能性、安全性评审；
      2. 更新全局变量code_review_result，输出评审报告和修改建议，生成代码评审RPC执行结果报告返回给主节点。

  # 子节点7：单元测试（RPC执行节点）
  - node_id: "TEST-UNIT-007"
    name: "单元测试（RPC执行节点）"
    description: "接收主节点RPC调度指令，执行单元测试任务，通过RPC返回执行结果"
    type: "自动节点"
    input:
      - rpc_source_service: "MASTER-MANAGE-000"
        rpc_request_path: "${global.master_rpc_path}"
        rpc_request_name: "子节点任务RPC执行指令.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
      - rpc_source_service: "DEV-CODE-REVIEW-006"
        rpc_request_path: "${global.review_report_path}"
        rpc_response_name: "代码评审RPC响应结果.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
      - rpc_source_service: "ARCH-DESIGN-003"
        rpc_request_path: "${global.arch_save_path}"
        rpc_response_name: "通用接口设计文档.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
    output:
      - rpc_content: "单元测试用例"
        rpc_target_service: "MASTER-MANAGE-000"
        rpc_request_path: "${global.test_case_path}"
        rpc_response_name: "单元测试用例.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
      - rpc_content: "单元测试报告"
        rpc_target_service: "MASTER-MANAGE-000"
        rpc_request_path: "${global.test_report_path}"
        rpc_response_name: "单元测试报告.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
      - rpc_content: "单元测试RPC执行结果报告"
        rpc_target_service: "MASTER-MANAGE-000"
        rpc_request_path: "${global.test_report_path}"
        rpc_response_name: "单元测试RPC响应结果.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
    connections:
      next_node: ["MASTER-MANAGE-000"]
    system_prompt: |
      你是单元测试RPC执行节点，仅负责接收主节点RPC指令并完成具体任务，通过RPC返回结果。
      核心要求：
      1. 基于主节点RPC指令和评审RPC响应数据，设计并执行单元测试，统计实际通过率；
      2. 更新全局变量unit_test_actual_pass_rate，输出测试用例和报告，生成单元测试RPC执行结果报告返回给主节点。

  # 子节点8：集成测试（RPC执行节点）
  - node_id: "TEST-INTEGRATION-008"
    name: "集成测试（RPC执行节点）"
    description: "接收主节点RPC调度指令，执行集成测试任务，通过RPC返回执行结果"
    type: "自动节点"
    input:
      - rpc_source_service: "MASTER-MANAGE-000"
        rpc_request_path: "${global.master_rpc_path}"
        rpc_request_name: "子节点任务RPC执行指令.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
      - rpc_source_service: "TEST-UNIT-007"
        rpc_request_path: "${global.test_report_path}"
        rpc_response_name: "单元测试RPC响应结果.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
      - rpc_source_service: "ARCH-DESIGN-003"
        rpc_request_path: "${global.arch_save_path}"
        rpc_response_name: "系统模块划分清单.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
    output:
      - rpc_content: "集成测试用例"
        rpc_target_service: "MASTER-MANAGE-000"
        rpc_request_path: "${global.test_case_path}"
        rpc_response_name: "集成测试用例.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
      - rpc_content: "集成测试报告"
        rpc_target_service: "MASTER-MANAGE-000"
        rpc_request_path: "${global.test_report_path}"
        rpc_response_name: "集成测试报告.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
      - rpc_content: "集成测试RPC执行结果报告"
        rpc_target_service: "MASTER-MANAGE-000"
        rpc_request_path: "${global.test_report_path}"
        rpc_response_name: "集成测试RPC响应结果.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
    connections:
      next_node: ["MASTER-MANAGE-000"]
    system_prompt: |
      你是集成测试RPC执行节点，仅负责接收主节点RPC指令并完成具体任务，通过RPC返回结果。
      核心要求：
      1. 基于主节点RPC指令和单元测试RPC响应数据，设计并执行集成测试，验证模块交互；
      2. 更新全局变量integration_test_result，输出测试用例和报告，生成集成测试RPC执行结果报告返回给主节点。

  # 子节点9：系统测试（RPC执行节点）
  - node_id: "TEST-SYSTEM-009"
    name: "系统测试（RPC执行节点）"
    description: "接收主节点RPC调度指令，执行系统测试任务，通过RPC返回执行结果"
    type: "自动节点"
    input:
      - rpc_source_service: "MASTER-MANAGE-000"
        rpc_request_path: "${global.master_rpc_path}"
        rpc_request_name: "子节点任务RPC执行指令.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
      - rpc_source_service: "TEST-INTEGRATION-008"
        rpc_request_path: "${global.test_report_path}"
        rpc_response_name: "集成测试RPC响应结果.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
      - rpc_source_service: "REQ-ANALYSIS-001"
        rpc_request_path: "${global.prd_save_path}"
        rpc_response_name: "标准化产品需求文档.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
    output:
      - rpc_content: "系统测试用例"
        rpc_target_service: "MASTER-MANAGE-000"
        rpc_request_path: "${global.test_case_path}"
        rpc_response_name: "系统测试用例.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
      - rpc_content: "系统测试报告"
        rpc_target_service: "MASTER-MANAGE-000"
        rpc_request_path: "${global.test_report_path}"
        rpc_response_name: "系统测试报告.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
      - rpc_content: "bug记录清单"
        rpc_target_service: "MASTER-MANAGE-000"
        rpc_request_path: "${global.bug_record_path}"
        rpc_response_name: "bug记录清单.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
      - rpc_content: "系统测试RPC执行结果报告"
        rpc_target_service: "MASTER-MANAGE-000"
        rpc_request_path: "${global.test_report_path}"
        rpc_response_name: "系统测试RPC响应结果.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
    connections:
      next_node: ["MASTER-MANAGE-000"]
    system_prompt: |
      你是系统测试RPC执行节点，仅负责接收主节点RPC指令并完成具体任务，通过RPC返回结果。
      核心要求：
      1. 基于主节点RPC指令和集成测试RPC响应数据，设计并执行全流程系统测试，记录所有Bug；
      2. 更新全局变量system_test_result、has_remaining_bugs，输出测试用例、报告和Bug清单，生成系统测试RPC执行结果报告返回给主节点。

  # 子节点10：bug修复迭代（RPC执行节点）
  - node_id: "BUG-FIX-ITERATION-010"
    name: "bug修复迭代（RPC执行节点）"
    description: "接收主节点RPC调度指令，执行Bug修复任务，通过RPC返回执行结果"
    type: "自动节点"
    input:
      - rpc_source_service: "MASTER-MANAGE-000"
        rpc_request_path: "${global.master_rpc_path}"
        rpc_request_name: "子节点任务RPC执行指令.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
      - rpc_source_service: "TEST-SYSTEM-009"
        rpc_request_path: "${global.bug_record_path}"
        rpc_response_name: "bug记录清单.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
      - rpc_source_service: "TEST-SYSTEM-009"
        rpc_request_path: "${global.test_report_path}"
        rpc_response_name: "系统测试RPC响应结果.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
    output:
      - rpc_content: "bug修复代码说明"
        rpc_target_service: "MASTER-MANAGE-000"
        rpc_request_path: "${global.code_dev_path}"
        rpc_response_name: "bug修复代码说明.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
      - rpc_content: "回归测试报告"
        rpc_target_service: "MASTER-MANAGE-000"
        rpc_request_path: "${global.fix_report_path}"
        rpc_response_name: "回归测试报告.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
      - rpc_content: "bug关闭清单"
        rpc_target_service: "MASTER-MANAGE-000"
        rpc_request_path: "${global.bug_record_path}"
        rpc_response_name: "bug关闭清单.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
      - rpc_content: "Bug修复RPC执行结果报告"
        rpc_target_service: "MASTER-MANAGE-000"
        rpc_request_path: "${global.fix_report_path}"
        rpc_response_name: "Bug修复RPC响应结果.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
    connections:
      next_node: ["MASTER-MANAGE-000"]
    system_prompt: |
      你是Bug修复RPC执行节点，仅负责接收主节点RPC指令并完成具体任务，通过RPC返回结果。
      核心要求：
      1. 基于主节点RPC指令和系统测试RPC响应数据，按优先级修复Bug并执行回归测试；
      2. 更新全局变量current_bug_fix_iteration、has_remaining_bugs，输出修复说明、回归报告和Bug关闭清单，生成Bug修复RPC执行结果报告返回给主节点。

  # 子节点11：人工合并代码（RPC人工执行节点）
  - node_id: "MANUAL-MERGE-CODE-011"
    name: "人工合并代码（RPC人工节点）"
    description: "接收主节点RPC调度指令，人工执行代码合并任务，通过RPC返回执行结果"
    type: "人工节点"
    input:
      - rpc_source_service: "MASTER-MANAGE-000"
        rpc_request_path: "${global.master_rpc_path}"
        rpc_request_name: "子节点任务RPC执行指令.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
      - rpc_source_service: "TEST-SYSTEM-009"
        rpc_request_path: "${global.test_report_path}"
        rpc_response_name: "系统测试RPC响应结果.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
      - rpc_source_service: "BUG-FIX-ITERATION-010"
        rpc_request_path: "${global.fix_report_path}"
        rpc_response_name: "Bug修复RPC响应结果.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
    output:
      - rpc_content: "代码合并完成记录"
        rpc_target_service: "MASTER-MANAGE-000"
        rpc_request_path: "${global.code_dev_path}"
        rpc_response_name: "代码合并完成记录.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
      - rpc_content: "主分支更新日志"
        rpc_target_service: "MASTER-MANAGE-000"
        rpc_request_path: "${global.code_dev_path}"
        rpc_response_name: "主分支更新日志.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
      - rpc_content: "代码合并RPC执行结果报告"
        rpc_target_service: "MASTER-MANAGE-000"
        rpc_request_path: "${global.code_dev_path}"
        rpc_response_name: "代码合并RPC响应结果.md"
        rpc_data_format: "${global.rpc_config.rpc_data_format}"
    connections:
      next_node: ["MASTER-MANAGE-000"]
    system_prompt: |
      你是负责代码合并的人类开发者，接收主节点RPC指令并完成操作，通过RPC返回结果。
      核心要求：
      1. 确认主节点RPC指令中所有测试通过、Bug已关闭，安全合并开发分支至主分支；
      2. 输出合并记录、更新日志，生成代码合并RPC执行结果报告返回给主节点。